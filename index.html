<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quest Proposal</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM (UMD for single file usage) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX compilation in browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts -->
    <style>
      @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
      
      body {
        margin: 0;
        overflow: hidden;
        background-color: #0f0518;
      }
      
      .font-pixel {
        font-family: 'VT323', 'Courier New', monospace;
      }

      /* CRT Scanline Effect */
      .scanlines {
        background: linear-gradient(
          to bottom,
          rgba(255,255,255,0),
          rgba(255,255,255,0) 50%,
          rgba(0,0,0,0.1) 50%,
          rgba(0,0,0,0.1)
        );
        background-size: 100% 4px;
        position: fixed;
        top: 0; right: 0; bottom: 0; left: 0;
        z-index: 50;
        pointer-events: none;
      }
    </style>
<script type="importmap">
{
  "imports": {
    "react/": "https://esm.sh/react@^19.2.3/",
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <div id="root"></div>
    <div class="scanlines"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- COMPONENT: PixelHeart ---
        const PixelHeart = () => {
          return (
            <div className="animate-bounce mb-4">
              <svg width="64" height="64" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M2 5H4V3H6V5H8V3H10V5H12V7H14V10H12V12H10V14H6V12H4V10H2V7Z" fill="#EC4899" stroke="#9D174D" strokeWidth="0.5" />
                <rect x="3" y="4" width="1" height="1" fill="white" fillOpacity="0.5"/>
                <rect x="4" y="5" width="1" height="1" fill="white" fillOpacity="0.5"/>
              </svg>
            </div>
          );
        };

        // --- COMPONENT: RetroButton ---
        const RetroButton = ({ children, className, ...props }) => {
          return (
            <button
              className={`
                relative px-6 py-3 
                font-pixel text-lg md:text-xl
                text-yellow-200 bg-gray-900 
                border-2 border-yellow-500 
                shadow-[4px_4px_0_0_rgba(180,83,9,1)]
                active:shadow-[1px_1px_0_0_rgba(180,83,9,1)]
                active:translate-x-[3px] active:translate-y-[3px]
                hover:bg-gray-800 hover:text-white
                transition-all duration-100 ease-in-out
                uppercase tracking-wider
                w-full md:w-auto
                ${className || ''}
              `}
              {...props}
            >
              <span className="flex items-center justify-center gap-2">
                <span className="text-pink-500 animate-pulse">‚ñ∂</span> 
                {children}
              </span>
            </button>
          );
        };

        // --- COMPONENT: PixelConfetti ---
        const PixelConfetti = () => {
          const particles = Array.from({ length: 60 }).map((_, i) => {
            const angle = Math.random() * 360;
            const distance = 100 + Math.random() * 400; 
            const tx = Math.cos((angle * Math.PI) / 180) * distance;
            const ty = Math.sin((angle * Math.PI) / 180) * distance;
            
            const colors = ['#FBBF24', '#EC4899', '#22D3EE', '#FFFFFF', '#A855F7'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            const delay = Math.random() * 0.5;

            return { id: i, tx, ty, color, delay };
          });

          return (
            <div className="absolute inset-0 overflow-hidden pointer-events-none z-0">
              <style>{`
                @keyframes pixel-explosion {
                  0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
                  100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
                }
              `}</style>
              <div className="absolute top-1/2 left-1/2 w-0 h-0">
                {particles.map((p) => (
                  <div
                    key={p.id}
                    className="absolute w-3 h-3"
                    style={{
                      backgroundColor: p.color,
                      '--tx': `${p.tx}px`,
                      '--ty': `${p.ty}px`,
                      animation: `pixel-explosion 1.5s ease-out forwards`,
                      animationDelay: `${p.delay}s`,
                      boxShadow: '2px 2px 0 rgba(0,0,0,0.2)',
                      left: 0,
                      top: 0,
                    }}
                  />
                ))}
              </div>
            </div>
          );
        };

        // --- COMPONENT: WalkingCat ---
        const WalkingCat = ({ onComplete }) => {
          const [hasReachedCenter, setHasReachedCenter] = useState(false);

          useEffect(() => {
            const timer = setTimeout(() => {
              setHasReachedCenter(true);
              onComplete();
            }, 4000);

            return () => clearTimeout(timer);
          }, [onComplete]);

          return (
            <div className="absolute inset-0 overflow-hidden pointer-events-none">
              <style>{`
                @keyframes walk-across {
                  0% { left: -300px; transform: translateX(0); }
                  100% { left: 50%; transform: translateX(-50%); }
                }
                @keyframes leg-wiggle {
                  0%, 100% { transform: translateY(0); }
                  50% { transform: translateY(-3px); }
                }
                @keyframes tail-wag {
                  0%, 100% { transform: rotate(0deg); }
                  50% { transform: rotate(10deg); }
                }
                .cat-container {
                  position: absolute;
                  bottom: 20px; 
                  display: flex;
                  align-items: flex-end;
                  animation: walk-across 4s linear forwards;
                  will-change: left, transform;
                }
                .walking .leg-1, .walking .leg-3 { animation: leg-wiggle 0.3s infinite; }
                .walking .leg-2, .walking .leg-4 { animation: leg-wiggle 0.3s infinite reverse; }
                .tail { transform-origin: bottom left; animation: tail-wag 1s infinite ease-in-out; }
                
                .stopped .leg-1, .stopped .leg-2, .stopped .leg-3, .stopped .leg-4 { animation: none; }
                .stopped .tail { animation: none; }
              `}</style>

              <div className={`cat-container ${hasReachedCenter ? 'stopped' : 'walking'}`}>
                <div className="flex items-end mr-3 mb-1 gap-2">
                   <div className="text-4xl animate-bounce" style={{ animationDuration: '0.6s', animationDelay: '0.1s' }}>‚òï</div>
                   <div className="text-4xl animate-bounce" style={{ animationDuration: '0.5s' }}>üç∞</div>
                </div>

                <svg width="80" height="60" viewBox="0 0 40 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <rect x="10" y="10" width="24" height="14" fill="#E2E8F0" />
                  <rect x="28" y="6" width="10" height="10" fill="#E2E8F0" />
                  <rect x="29" y="3" width="2" height="3" fill="#E2E8F0" />
                  <rect x="35" y="3" width="2" height="3" fill="#E2E8F0" />
                  <rect x="30" y="9" width="2" height="2" fill="#1E293B" />
                  <rect x="36" y="9" width="2" height="2" fill="#1E293B" />
                  <rect x="33" y="11" width="2" height="1" fill="#F472B6" />
                  <path className="tail" d="M10 12 L4 8 L2 4" stroke="#E2E8F0" strokeWidth="3" fill="none" />
                  <rect className="leg-1" x="12" y="24" width="4" height="6" fill="#CBD5E1" />
                  <rect className="leg-2" x="18" y="24" width="4" height="6" fill="#CBD5E1" />
                  <rect className="leg-3" x="24" y="24" width="4" height="6" fill="#CBD5E1" />
                  <rect className="leg-4" x="30" y="24" width="4" height="6" fill="#CBD5E1" />
                </svg>

                {!hasReachedCenter && (
                  <div className="absolute -top-10 right-0 bg-white text-black text-xs px-2 py-1 font-pixel border-2 border-black whitespace-nowrap shadow-[2px_2px_0_rgba(0,0,0,0.5)]">
                    Delivery!
                  </div>
                )}
              </div>
            </div>
          );
        };

        // --- MAIN APP COMPONENT ---
        const App = () => {
          const [step, setStep] = useState('intro');
          const [showFinalText, setShowFinalText] = useState(false);
          const [secretPos, setSecretPos] = useState({ top: '80%', left: '80%' });

          // Update secret button position every 1 second
          useEffect(() => {
            const interval = setInterval(() => {
              const newTop = Math.floor(Math.random() * 80 + 10) + '%';
              const newLeft = Math.floor(Math.random() * 80 + 10) + '%';
              setSecretPos({ top: newTop, left: newLeft });
            }, 1000);

            return () => clearInterval(interval);
          }, []);

          const handleVerify = () => setStep('accept_relic');
          const handleClaim = () => setStep('animating');
          const handleAnimationComplete = () => {
            setStep('finished');
            setTimeout(() => setShowFinalText(true), 500);
          };

          const triggerSecret = () => {
            setStep('secret');
          };

          return (
            <div className={`min-h-screen w-full flex flex-col items-center justify-center p-4 relative overflow-hidden font-pixel transition-all duration-1000 ${step === 'secret' ? 'bg-gradient-to-tr from-pink-500 via-yellow-400 to-cyan-500' : 'bg-gradient-to-br from-slate-900 via-purple-900 to-black'}`}>
              
              {/* Secret texture overlay */}
              {step === 'secret' && (
                <div className="absolute inset-0 opacity-20 pointer-events-none" style={{ backgroundImage: 'radial-gradient(#fff 1px, transparent 1px)', backgroundSize: '20px 20px' }}></div>
              )}

              <div className="absolute top-4 left-4 w-8 h-8 border-t-4 border-l-4 border-yellow-500"></div>
              <div className="absolute top-4 right-4 w-8 h-8 border-t-4 border-r-4 border-yellow-500"></div>
              <div className="absolute bottom-4 left-4 w-8 h-8 border-b-4 border-l-4 border-yellow-500"></div>
              <div className="absolute bottom-4 right-4 w-8 h-8 border-b-4 border-r-4 border-yellow-500"></div>
              
              {/* The Randomly Moving Secret Button - Now only visible after claim */}
              {(step === 'animating' || step === 'finished') && (
                <button 
                  onClick={triggerSecret}
                  className="absolute text-2xl cursor-pointer opacity-30 hover:opacity-100 transition-all duration-1000 ease-in-out animate-pulse z-50 p-4"
                  style={{ 
                    top: secretPos.top, 
                    left: secretPos.left,
                    filter: 'drop-shadow(0 0 10px white)',
                    transform: 'translate(-50%, -50%)'
                  }}
                >
                  ‚ú®
                </button>
              )}

              {(showFinalText || step === 'secret') && <PixelConfetti />}

              <div className="z-10 w-full max-w-2xl">
                
                {step === 'intro' && (
                  <div className="animate-in fade-in slide-in-from-bottom-4 duration-700">
                    <div className="bg-gray-900/90 border-4 border-yellow-500 p-6 md:p-8 shadow-2xl backdrop-blur-sm">
                      <div className="flex justify-center"><PixelHeart /></div>
                      <h1 className="text-pink-400 text-2xl md:text-3xl mb-4 tracking-widest border-b-2 border-pink-900 pb-2">SYSTEM ALERT</h1>
                      <p className="text-gray-200 text-lg md:text-xl leading-relaxed mb-8">
                        A Hero has deposited a <span className="text-yellow-400">Mythic Relic</span> in this server. <br /><br />
                        <span className="text-green-400">{`> Query:`}</span> Art thou the NPC Maiden who hath traveled from the Dating Realm to claim this offering?
                      </p>
                      <div className="flex justify-center">
                        <RetroButton onClick={handleVerify}>Yea, 'tis I. Thus I have arrived to collect the bounty.</RetroButton>
                      </div>
                    </div>
                  </div>
                )}

                {step === 'accept_relic' && (
                  <div className="animate-in fade-in zoom-in-95 duration-500">
                    <div className="bg-gray-900/90 border-4 border-yellow-500 p-6 md:p-8 shadow-2xl backdrop-blur-sm">
                      <h1 className="text-green-400 text-2xl md:text-3xl mb-4 tracking-widest border-b-2 border-green-900 pb-2">IDENTITY VERIFIED</h1>
                      <p className="text-gray-200 text-lg md:text-xl leading-relaxed mb-6">
                        The Relic contains: <span className="text-pink-400 font-bold">[Date Night: The Sweetest Adventure]</span>.<br />
                        <span className="text-yellow-500 text-sm uppercase tracking-widest">Rarity: Legendary</span><br /><br />
                        Dost thou wish to add this to thy inventory?
                      </p>
                      <div className="flex justify-center">
                        <RetroButton onClick={handleClaim}>‚ú® I claim this treasure! ‚ú®</RetroButton>
                      </div>
                    </div>
                  </div>
                )}

                {(step === 'animating' || step === 'finished') && (
                  <div className="relative h-96 w-full">
                    <WalkingCat onComplete={handleAnimationComplete} />
                    <div className={`
                      absolute inset-0 flex flex-col items-center justify-start pt-24 text-center z-20
                      transition-all duration-1000 ease-out transform
                      ${showFinalText ? 'opacity-100 scale-100' : 'opacity-0 scale-90'}
                    `}>
                      <h1 className="text-5xl md:text-6xl text-yellow-400 font-bold drop-shadow-[4px_4px_0_rgba(0,0,0,1)] mb-4 animate-bounce">
                        ‚ú® QUEST COMPLETE! ‚ú®
                      </h1>
                      <p className="text-pink-300 text-xl md:text-2xl drop-shadow-[2px_2px_0_rgba(0,0,0,0.8)] tracking-wide bg-black/40 px-4 py-2 rounded">
                        (amtarhn ideerei hahaha)
                      </p>
                    </div>
                  </div>
                )}

                {step === 'secret' && (
                  <div className="animate-in zoom-in duration-500 flex flex-col items-center text-center">
                    <div className="bg-white/30 backdrop-blur-xl border-8 border-white p-10 shadow-[10px_10px_0_rgba(0,0,0,0.2)]">
                      <h2 className="text-4xl md:text-6xl font-bold mb-6 text-white drop-shadow-[4px_4px_0_#ff00ff] italic">CONGRATS!</h2>
                      <div className="bg-black/80 p-6 border-4 border-cyan-400 mb-8">
                        <p className="text-2xl md:text-4xl text-yellow-300 leading-tight">
                          you just found the secret:<br/>
                          <span className="text-pink-400 underline decoration-wavy underline-offset-8">"wanna go on a date with me?"</span>
                        </p>
                      </div>
                      <div className="flex justify-center gap-4 mb-8 text-6xl">
                        <span className="animate-bounce">üíñ</span>
                        <span className="animate-bounce" style={{animationDelay:'0.2s'}}>üíê</span>
                        <span className="animate-bounce" style={{animationDelay:'0.4s'}}>‚ú®</span>
                      </div>
                      <div className="text-black/70 text-lg font-sans italic border-t border-white/40 pt-4">
                        (haraanii byad huruunii hurd hurdan bainashu hhaha)
                      </div>
                      <div className="mt-8">
                        <RetroButton onClick={() => setStep('intro')} className="!bg-pink-600 !border-white text-white">
                          Back to Quest
                        </RetroButton>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>